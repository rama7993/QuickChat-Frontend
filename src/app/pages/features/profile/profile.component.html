<div class="profile-container">
  <div class="profile-header">
    <h1>Profile Settings</h1>
    <p>Manage your account settings and preferences</p>
  </div>

  <div class="profile-content">
    <!-- Tab Navigation -->
    <div class="tab-navigation">
      <button
        class="tab-btn"
        [class.active]="activeTab() === 'basic'"
        (click)="setActiveTab('basic')"
      >
        <i class="pi pi-user"></i>
        Basic Info
      </button>
      <button
        class="tab-btn"
        [class.active]="activeTab() === 'privacy'"
        (click)="setActiveTab('privacy')"
      >
        <i class="pi pi-shield"></i>
        Privacy
      </button>
    </div>

    <!-- Tab Content -->
    <form
      [formGroup]="profileForm"
      (ngSubmit)="onSubmit()"
      class="profile-form"
    >
      <!-- Basic Information Tab -->
      @if (activeTab() === 'basic') {
      <div class="tab-content">
        <div class="section">
          <h2>Personal Information</h2>
          <div class="form-grid">
            <div class="form-group">
              <label for="firstName">First Name</label>
              <input
                type="text"
                id="firstName"
                formControlName="firstName"
                class="form-input"
                placeholder="Enter your first name"
              />
            </div>

            <div class="form-group">
              <label for="lastName">Last Name</label>
              <input
                type="text"
                id="lastName"
                formControlName="lastName"
                class="form-input"
                placeholder="Enter your last name"
              />
            </div>

            <div class="form-group">
              <label for="email">Email Address</label>
              <input
                type="email"
                id="email"
                formControlName="email"
                class="form-input"
                placeholder="Enter your email"
              />
            </div>

            <div class="form-group">
              <label for="phone">Phone Number</label>
              <input
                type="tel"
                id="phone"
                formControlName="phone"
                class="form-input"
                placeholder="Enter your phone number"
              />
            </div>

            <div class="form-group full-width">
              <label for="bio">Bio</label>
              <textarea
                id="bio"
                formControlName="bio"
                class="form-textarea"
                placeholder="Tell us about yourself"
                rows="4"
              ></textarea>
            </div>
          </div>
        </div>

        <div class="section">
          <h2>Profile Picture</h2>
          <div class="profile-picture-section">
            <div class="current-picture">
              <img
                [src]="currentUser()?.photoUrl || defaultAvatar"
                alt="Profile Picture"
                class="profile-image"
              />
            </div>
            <div class="picture-actions">
              <button
                type="button"
                class="btn btn-secondary"
                (click)="changeProfilePicture()"
              >
                <i class="pi pi-camera"></i>
                Change Picture
              </button>
              <button
                type="button"
                class="btn btn-outline"
                (click)="removeProfilePicture()"
              >
                <i class="pi pi-trash"></i>
                Remove
              </button>
            </div>
          </div>
        </div>
      </div>
      }

      <!-- Privacy Tab -->
      @if (activeTab() === 'privacy') {
      <div class="tab-content">
        <div class="section">
          <h2>Privacy Settings</h2>
          <div formGroupName="privacySettings" class="settings-list">
            <div class="setting-item">
              <div class="setting-info">
                <h3>Show Last Seen</h3>
                <p>Allow others to see when you were last active</p>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" formControlName="showLastSeen" />
                <span class="slider"></span>
              </label>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <h3>Show Status</h3>
                <p>Allow others to see your current status</p>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" formControlName="showStatus" />
                <span class="slider"></span>
              </label>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <h3>Allow Group Invites</h3>
                <p>Let others invite you to groups</p>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" formControlName="allowGroupInvites" />
                <span class="slider"></span>
              </label>
            </div>

            <div class="setting-item">
              <div class="setting-info">
                <h3>Show Online Status</h3>
                <p>Display when you're online to other users</p>
              </div>
              <label class="toggle-switch">
                <input type="checkbox" formControlName="showOnlineStatus" />
                <span class="slider"></span>
              </label>
            </div>
          </div>
        </div>
      </div>
      }

      <!-- Form Actions -->
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" (click)="goBack()">
          Cancel
        </button>
        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="profileForm.invalid || isUpdating()"
        >
          @if (isUpdating()) {
          <i class="pi pi-spin pi-spinner"></i>
          Updating... } @else {
          <i class="pi pi-check"></i>
          Save Changes }
        </button>
      </div>
    </form>
  </div>
</div>
